<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BTMR CLOUD PRO</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://img.icons8.com/fluency/180/00d4ff/cloud-checked.png">

    <script>
        // --- BAHAGIAN KONFIGURASI DATA ---
        const APP_NAME = "BTMR CLOUD PRO";
        const COUNTRIES = [
            {g:"SEMUA", d:"1 Jun 2024", n:"Albania", c:"AL"}, {g:"SEMUA", d:"1 Jun 2024", n:"Andorra", c:"AD"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Armenia", c:"AM"}, {g:"SEMUA", d:"1 Jun 2024", n:"Australia", c:"AU"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Austria", c:"AT"}, {g:"SEMUA", d:"1 Jun 2024", n:"Azerbaijan", c:"AZ"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Bahrain", c:"BH"}, {g:"SEMUA", d:"1 Jun 2024", n:"Belarus", c:"BY"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Belgium", c:"BE"}, {g:"SEMUA", d:"1 Jun 2024", n:"Bosnia and Herzegovina", c:"BA"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Brunei", c:"BN"}, {g:"SEMUA", d:"1 Jun 2024", n:"Bulgaria", c:"BG"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Canada", c:"CA"}, {g:"SEMUA", d:"1 Jun 2024", n:"China", c:"CN"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Croatia", c:"HR"}, {g:"SEMUA", d:"1 Jun 2024", n:"Cyprus", c:"CY"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Czech Republic", c:"CZ"}, {g:"SEMUA", d:"1 Jun 2024", n:"Denmark", c:"DK"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Estonia", c:"EE"}, {g:"SEMUA", d:"1 Jun 2024", n:"Finland", c:"FI"},
            {g:"SEMUA", d:"1 Jun 2024", n:"France", c:"FR"}, {g:"SEMUA", d:"1 Jun 2024", n:"Georgia", c:"GE"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Germany", c:"DE"}, {g:"SEMUA", d:"1 Jun 2024", n:"Greece", c:"GR"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Hong Kong SAR", c:"HK"}, {g:"SEMUA", d:"1 Jun 2024", n:"Hungary", c:"HU"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Iceland", c:"IS"}, {g:"SEMUA", d:"1 Jun 2024", n:"Ireland", c:"IE"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Italy", c:"IT"}, {g:"SEMUA", d:"1 Jun 2024", n:"Japan", c:"JP"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Jordan", c:"JO"}, {g:"SEMUA", d:"1 Jun 2024", n:"Kuwait", c:"KW"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Latvia", c:"LV"}, {g:"SEMUA", d:"1 Jun 2024", n:"Liechtenstein", c:"LI"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Lithuania", c:"LT"}, {g:"SEMUA", d:"1 Jun 2024", n:"Luxembourg", c:"LU"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Malta", c:"MT"}, {g:"SEMUA", d:"1 Jun 2024", n:"Moldova", c:"MD"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Netherlands", c:"NL"}, {g:"SEMUA", d:"1 Jun 2024", n:"New Zealand", c:"NZ"},
            {g:"SEMUA", d:"1 Jun 2024", n:"North Macedonia", c:"MK"}, {g:"SEMUA", d:"1 Jun 2024", n:"Norway", c:"NO"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Oman", c:"OM"}, {g:"SEMUA", d:"1 Jun 2024", n:"Poland", c:"PL"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Portugal", c:"PT"}, {g:"SEMUA", d:"1 Jun 2024", n:"Qatar", c:"QA"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Romania", c:"RO"}, {g:"SEMUA", d:"1 Jun 2024", n:"Russia", c:"RU"},
            {g:"SEMUA", d:"1 Jun 2024", n:"San Marino", c:"SM"}, {g:"SEMUA", d:"1 Jun 2024", n:"Saudi Arabia", c:"SA"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Singapore", c:"SG"}, {g:"SEMUA", d:"1 Jun 2024", n:"Slovakia", c:"SK"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Slovenia", c:"SI"}, {g:"SEMUA", d:"1 Jun 2024", n:"South Korea", c:"KR"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Spain", c:"ES"}, {g:"SEMUA", d:"1 Jun 2024", n:"Sweden", c:"SE"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Switzerland", c:"CH"}, {g:"SEMUA", d:"1 Jun 2024", n:"Taiwan", c:"TW"},
            {g:"SEMUA", d:"1 Jun 2024", n:"Turkey", c:"TR"}, {g:"SEMUA", d:"1 Jun 2024", n:"Ukraine", c:"UA"},
            {g:"SEMUA", d:"1 Jun 2024", n:"United Arab Emirates", c:"AE"}, {g:"SEMUA", d:"1 Jun 2024", n:"United Kingdom", c:"GB"},
            {g:"SEMUA", d:"1 Jun 2024", n:"United States", c:"US"},
            {g:"ASEAN", d:"15 Feb 2025", n:"Cambodia", c:"KH"}, {g:"ASEAN", d:"15 Feb 2025", n:"Indonesia", c:"ID"},
            {g:"ASEAN", d:"15 Feb 2025", n:"Laos", c:"LA"}, {g:"ASEAN", d:"15 Feb 2025", n:"Myanmar", c:"MM"},
            {g:"ASEAN", d:"15 Feb 2025", n:"Philippines", c:"PH"}, {g:"ASEAN", d:"15 Feb 2025", n:"Thailand", c:"TH"},
            {g:"ASEAN", d:"15 Feb 2025", n:"Vietnam", c:"VN"}, {g:"ASEAN", d:"15 Feb 2025", n:"Timor-Leste", c:"TL"}
        ];
    </script>

    <style>
        :root { --navy: #001D3D; --blue: #00D4FF; --glass: rgba(255,255,255,0.08); }
        body { font-family: -apple-system, sans-serif; background: #000814; color: white; margin: 0; padding-bottom: 100px; }
        .header { position: sticky; top: 0; padding: 50px 15px 15px; background: rgba(0,8,20,0.7); backdrop-filter: blur(20px); border-bottom: 0.5px solid rgba(255,255,255,0.1); z-index: 100; text-align: center; }
        .page { display: none; padding: 15px; }
        .active { display: block; }
        .card { background: var(--glass); border-radius: 20px; padding: 20px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 15px; }
        input { width: 100%; padding: 15px; border-radius: 12px; border: none; background: rgba(255,255,255,0.1); color: white; box-sizing: border-box; }
        .tab-bar { position: fixed; bottom: 0; width: 100%; height: 85px; background: rgba(0,8,20,0.9); display: flex; justify-content: space-around; padding-top: 10px; border-top: 0.5px solid rgba(255,255,255,0.1); }
        .tab { color: gray; text-decoration: none; font-size: 10px; text-align: center; }
        .tab.active-tab { color: var(--blue); }
    </style>
</head>
<body>
    <div class="header"><h1 id="title">BTMR CLOUD</h1></div>

   <div id="p1" class="page active">
        <div id="userProfile" class="card" style="display:none; border-left: 5px solid #00D4FF;">
            <p style="margin:0; font-size:12px; opacity:0.6;">Pegawai Bertugas:</p>
            <h2 id="displayNama" style="margin:5px 0 0 0; font-size:20px;">-</h2>
            <p id="displayID" style="margin:0; font-size:12px; color:#00D4FF;">ID: -</p>
            <button onclick="logout()" style="margin-top:15px; background:none; border:1px solid red; color:red; padding:5px 10px; border-radius:8px; font-size:10px;">LOG KELUAR</button>
        </div>

        <div id="authForm" class="card">
            <h3 id="authTitle">Log Masuk Pegawai</h3>
            <p id="authDesc" style="font-size:12px; opacity:0.7;">Sila masukkan ID untuk akses jadual.</p>
            
            <div style="margin-bottom:15px;">
                <label style="font-size:11px; color:#00D4FF;">ID PEGAWAI</label>
                <input type="text" id="userID" placeholder="Contoh: BTMR123">
            </div>
            
            <div id="nameField" style="margin-bottom:15px; display:none;">
                <label style="font-size:11px; color:#00D4FF;">NAMA PENUH</label>
                <input type="text" id="userName" placeholder="Nama anda">
            </div>

            <button id="mainBtn" onclick="handleAuth()" style="width:100%; padding:15px; border-radius:12px; border:none; background:#00D4FF; color:#001D3D; font-weight:bold; font-size:16px;">LOG MASUK</button>
            
            <p style="text-align:center; font-size:12px; margin-top:15px;">
                <span id="toggleText">Tiada ID pegawai?</span> 
                <a href="javascript:void(0)" id="toggleLink" onclick="toggleAuthMode()" style="color:#00D4FF; text-decoration:none; font-weight:bold;">Daftar Sekarang</a>
            </p>
        </div>
    </div>
        <div class="card"><h3>Jadual Tugas</h3><p>Mod kemaskini awan aktif.</p></div>
    </div>

    <div id="p2" class="page">
        <input type="text" id="src" placeholder="Cari negara..." onkeyup="search()">
        <div id="list" style="margin-top:20px"></div>
    </div>

    <nav class="tab-bar">
        <a href="#" class="tab active-tab" onclick="nav(1,'JADUAL TUGAS',this)"><span>üìÖ</span><br>Jadual</a>
        <a href="#" class="tab" onclick="nav(2,'INFO NEGARA',this)"><span>üåç</span><br>Negara</a>
    </nav>

 <script>
    // 1. Fungsi Navigasi Tab
    function nav(n, t, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('p' + n).classList.add('active');
        document.querySelectorAll('.tab').forEach(b => b.classList.remove('active-tab'));
        el.classList.add('active-tab');
        document.getElementById('title').innerText = t;
        if (n === 2) render(COUNTRIES);
    }

    // 2. Fungsi Tukar Kod ke Bendera (INI YANG PENTING)
    function getFlag(c) {
        return c.toUpperCase().replace(/./g, char => 
            String.fromCodePoint(char.charCodeAt(0) + 127397)
        );
    }

    // 3. Fungsi Papar Senarai Negara
    function render(l) {
        const container = document.getElementById('list');
        if (l.length === 0) {
            container.innerHTML = '<p style="text-align:center; opacity:0.5;">Tiada padanan.</p>';
            return;
        }
        // Susun A-Z dan papar
        container.innerHTML = l.sort((a, b) => a.n.localeCompare(b.n)).map(i => `
            <div class="card" style="display:flex; align-items:center; padding:15px; margin-bottom:10px;">
                <div style="font-size:30px; margin-right:15px;">${getFlag(i.c)}</div>
                <div style="flex:1">
                    <div style="font-weight:bold; font-size:16px;">${i.n}</div>
                    <div style="font-size:11px; color:#00D4FF;">${i.c} ‚Ä¢ Mula: ${i.d}</div>
                </div>
                <div style="font-size:9px; background:rgba(255,255,255,0.1); padding:4px 8px; border-radius:8px;">${i.g}</div>
            </div>
        `).join('');
    }

    // 4. Fungsi Carian
    function search() {
        let v = document.getElementById('src').value.toLowerCase();
        const hasil = COUNTRIES.filter(i => 
            i.n.toLowerCase().includes(v) || i.c.toLowerCase().includes(v)
        );
        render(hasil);
    }

    // Papar data secara automatik apabila mula
    window.onload = () => { render(COUNTRIES); };
    let isLoginMode = true;

    function toggleAuthMode() {
        isLoginMode = !isLoginMode;
        const nameField = document.getElementById('nameField');
        const authTitle = document.getElementById('authTitle');
        const mainBtn = document.getElementById('mainBtn');
        const toggleLink = document.getElementById('toggleLink');
        const toggleText = document.getElementById('toggleText');

        if (isLoginMode) {
            authTitle.innerText = "Log Masuk Pegawai";
            nameField.style.display = "none";
            mainBtn.innerText = "LOG MASUK";
            toggleText.innerText = "Tiada ID pegawai?";
            toggleLink.innerText = "Daftar Sekarang";
        } else {
            authTitle.innerText = "Pendaftaran Pegawai";
            nameField.style.display = "block";
            mainBtn.innerText = "DAFTAR AKAUN";
            toggleText.innerText = "Sudah ada ID?";
            toggleLink.innerText = "Log Masuk";
        }
    }

    function handleAuth() {
        const id = document.getElementById('userID').value.trim();
        const name = document.getElementById('userName').value.trim();

        if (!id) return alert("Sila masukkan ID Pegawai");

        if (isLoginMode) {
            // Proses Login
            const savedUser = localStorage.getItem('user_' + id);
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                loginSuccess(userData);
            } else {
                alert("ID tidak ditemui. Sila daftar dahulu.");
            }
        } else {
            // Proses Daftar
            if (!name) return alert("Sila masukkan nama penuh");
            const userData = { id: id, name: name };
            localStorage.setItem('user_' + id, JSON.stringify(userData));
            alert("Pendaftaran berjaya! Sila Log Masuk.");
            toggleAuthMode();
        }
    }

    function loginSuccess(user) {
        localStorage.setItem('currentUser', JSON.stringify(user));
        document.getElementById('authForm').style.display = "none";
        document.getElementById('userProfile').style.display = "block";
        document.getElementById('displayNama').innerText = user.name;
        document.getElementById('displayID').innerText = "ID: " + user.id;
        if (navigator.vibrate) navigator.vibrate([50, 30, 50]);
    }

    function logout() {
        localStorage.removeItem('currentUser');
        location.reload();
    }

    // Semak sesi login sedia ada apabila aplikasi dibuka
    window.addEventListener('load', () => {
        const session = localStorage.getItem('currentUser');
        if (session) {
            loginSuccess(JSON.parse(session));
        }
    });
    
</script>
